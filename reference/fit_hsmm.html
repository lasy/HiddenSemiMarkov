<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fits a hidden semi-Markov model to data sequences — fit_hsmm • HiddenSemiMarkov</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fits a hidden semi-Markov model to data sequences — fit_hsmm" />
<meta property="og:description" content="This function relies on a EM procedure to fit the model parameters to maximize the likelihood of the decoded hidden state sequence.
It returns a list whose first element is the fitted model (an object of class hsmm) and whose second elements provides information about the EM procedure (convergence, number of iteration, likelihood)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HiddenSemiMarkov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/HiddenSemiMarkov.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fits a hidden semi-Markov model to data sequences</h1>
    
    <div class="hidden name"><code>fit_hsmm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function relies on a EM procedure to fit the model parameters to maximize the likelihood of the decoded hidden state sequence.
It returns a list whose first element is the fitted model (an object of class <code>hsmm</code>) and whose second elements provides information about the EM procedure (convergence, number of iteration, likelihood).</p>
    </div>

    <pre class="usage"><span class='fu'>fit_hsmm</span><span class='op'>(</span>
  <span class='va'>model</span>,
  <span class='va'>X</span>,
  n_iter <span class='op'>=</span> <span class='fl'>10</span>,
  rel_tol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>20</span>,
  lock_emission <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lock_transition <span class='op'>=</span> <span class='cn'>FALSE</span>,
  lock_sojourn <span class='op'>=</span> <span class='cn'>FALSE</span>,
  N0 <span class='op'>=</span> <span class='fl'>0</span>,
  use_sojourn_prior <span class='op'>=</span> <span class='cn'>FALSE</span>,
  ground_truth <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='op'>)</span>,
  trust_in_ground_truth <span class='op'>=</span> <span class='fl'>0.75</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  graphical <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>a <code>hsmm</code> object. The model whose parameters will be re-estimated.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>a <code>data.frame</code> of observations.</p></td>
    </tr>
    <tr>
      <th>n_iter</th>
      <td><p>(optional) an integer specifying the maximal number of iterations for the EM-procedure. Default value is 10.</p></td>
    </tr>
    <tr>
      <th>rel_tol</th>
      <td><p>(optional) a positive double specifying the tolerance at which to stop the EM. If the difference in likelihood (normalized by the total sequences length) between two iterations of the EM is smaller than <code>rel_tol</code>, then the EM procedure is considered to have converged to a local maximum.</p></td>
    </tr>
    <tr>
      <th>lock_emission</th>
      <td><p>(optional) a logical. Default is <code>FALSE</code>. Specifies if the emission distributions should be locked (kept as is) or re-estimated at the M-step of the EM.</p></td>
    </tr>
    <tr>
      <th>lock_transition</th>
      <td><p>(optional) a logical. Default is <code>FALSE</code>. Specifies if the transition probability should be locked (kept as is) or re-estimated at the M-step of the EM.</p></td>
    </tr>
    <tr>
      <th>lock_sojourn</th>
      <td><p>(optional) a logical. Default is <code>FALSE</code>. Specifies if the sojourn distributions should be locked (kept as is) or re-estimated at the M-step of the EM.</p></td>
    </tr>
    <tr>
      <th>N0</th>
      <td><p>(optional) a positive number specifying the strength of the prior, i.e. the number of observations (or believed number of observations) which informed the specification of the emission distributions. This number will be used to weight the specified emission distribution against the total lenght of the sequences provided for the fit.</p></td>
    </tr>
    <tr>
      <th>use_sojourn_prior</th>
      <td><p>(optional) a logical. Default is <code>TRUE</code>. Specifies if the specified sojourn distributions should be used as a prior when updating the prior distributions at the M-step of the EM.</p></td>
    </tr>
    <tr>
      <th>ground_truth</th>
      <td><p>(optional) a <code>data.frame</code> of ground truth, _i.e._ time-points where the hidden state is known. Default is an empty <code>data.frame</code>, _i.e._ no ground truth.</p></td>
    </tr>
    <tr>
      <th>trust_in_ground_truth</th>
      <td><p>(optional) a double between 0 and 1 specifying the trust in the ground truth. A value of 0 indicates no trust and is equivalent to not providing ground-truth. A value of 1 indicates full trust and the ground truth will not be modulated by the probability of the values of the observations.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>a logical (default = <code>FALSE</code>). Should the function print additional information?</p></td>
    </tr>
    <tr>
      <th>graphical</th>
      <td><p>a logical (default = <code>FALSE</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list. First element of the list (<code>$model</code>) is a <code>hsmm</code> object (the fitted model) and the second element (<code>$fit_param</code>) provides information about the EM-procedure. The second element can be visualized by calling the function <code>plot_hsmm_fit_param()</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Y. Guédon, Estimating Hidden Semi-Markov Chains from Discrete Sequences. Journal of Computational and Graphical Statistics. 12, 604–639 (2003) <a href='https://www.tandfonline.com/doi/abs/10.1198/1061860032030'>https://www.tandfonline.com/doi/abs/10.1198/1061860032030</a></p>
<p>J. O’Connell, S. Hojsgaard, Hidden semi-Markov models for multiple observation sequences: The mhsmm package for R. Journal of Statistical Software. 39, 1–22 (2011) <a href='https://www.jstatsoft.org/article/view/v039i04'>https://www.jstatsoft.org/article/view/v039i04</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>my_model</span> <span class='op'>=</span> <span class='va'>simple_model</span>  <span class='co'># simple_model is a model attached to the HiddenSemiMarkov package for demos</span>
<span class='va'>Xsim</span> <span class='op'>=</span> <span class='fu'><a href='simulate_hsmm.html'>simulate_hsmm</a></span><span class='op'>(</span><span class='va'>my_model</span>, n_state_transitions <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='co'># a short sequence is simulated</span>

<span class='va'>my_model_fit</span> <span class='op'>=</span> <span class='fu'>fit_hsmm</span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>my_model</span>, X <span class='op'>=</span> <span class='va'>Xsim</span><span class='op'>)</span> <span class='co'># the model is fit to the observations.</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The `.dots` argument of `group_by()` is deprecated as of dplyr 1.0.0.</span></div><div class='input'><span class='fu'><a href='plot_hsmm_fit_status.html'>plot_hsmm_fit_status</a></span><span class='op'>(</span>fit_output <span class='op'>=</span> <span class='va'>my_model_fit</span><span class='op'>)</span>
</div><div class='img'><img src='fit_hsmm-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>viterbi_init</span> <span class='op'>=</span> <span class='fu'><a href='predict_states_hsmm.html'>predict_states_hsmm</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>my_model</span>, X <span class='op'>=</span> <span class='va'>Xsim</span>, method <span class='op'>=</span> <span class='st'>"Viterbi"</span><span class='op'>)</span> <span class='co'># predict the states with the initial model</span>
<span class='va'>viterbi_fit</span> <span class='op'>=</span> <span class='fu'><a href='predict_states_hsmm.html'>predict_states_hsmm</a></span><span class='op'>(</span>model <span class='op'>=</span> <span class='va'>my_model_fit</span><span class='op'>$</span><span class='va'>model</span>, X <span class='op'>=</span> <span class='va'>Xsim</span>, method <span class='op'>=</span> <span class='st'>"Viterbi"</span><span class='op'>)</span> <span class='co'># predict the states with the fit model</span>
<span class='va'>Xsim</span><span class='op'>$</span><span class='va'>state_viterbi_init</span> <span class='op'>=</span> <span class='va'>viterbi_init</span><span class='op'>$</span><span class='va'>state_seq</span><span class='op'>$</span><span class='va'>state</span>
<span class='va'>Xsim</span><span class='op'>$</span><span class='va'>state_viterbi_fit</span> <span class='op'>=</span> <span class='va'>viterbi_fit</span><span class='op'>$</span><span class='va'>state_seq</span><span class='op'>$</span><span class='va'>state</span>
<span class='fu'><a href='plot_hsmm_seq.html'>plot_hsmm_seq</a></span><span class='op'>(</span>X <span class='op'>=</span> <span class='va'>Xsim</span>, model <span class='op'>=</span> <span class='va'>my_model</span><span class='op'>)</span>
</div><div class='img'><img src='fit_hsmm-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laura Symul.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


